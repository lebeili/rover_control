<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://kit.fontawesome.com/f7310fb2c0.js" crossorigin="anonymous"></script>
  <link href="https://api.mapbox.com/mapbox-gl-js/v3.1.2/mapbox-gl.css" rel="stylesheet">
<script src="https://api.mapbox.com/mapbox-gl-js/v3.1.2/mapbox-gl.js"></script>
<style>
    #map { position: absolute; top: 0; bottom: 0; height: 300px; }
    </style>
<title>Rover control panel</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
    }
    .grid-container {
      display: grid;
	  grid-template-columns: 4fr 2fr;
    }


    .grid-item {
      border: 1px solid #ddd;
    }

	.left-grid-subcontainer{
		display: grid;
	    grid-template-columns: 2fr 2fr;
		grid-template-rows: repeat(2, 1fr);
	}
	.right-grid-subcontainer{
	    display: grid;
	}
    .grid-item i {
    font-size: 32px;
}


    .slider {
      width: 80%;
      max-width: 300px;
      margin: 0 auto;
    }
	


#joy1Div
{
	width:100%;
}


  </style>
  <script src="joy.js"></script>
</head>
<body>

  <div class="grid-container">
    <div class="left-grid-subcontainer">
		<div class="grid-item" style="height: 446px;">
			<iframe width="100%" height="446" src="https://www.youtube.com/embed/1ZmYX5nVwLc?si=Xq6evGoaQga1UwYk" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
		</div>
		<div class="grid-item" id="map-container">
        </div>
		<div class="grid-item">
				  		<div class="row">
			<div class="columnLateral">
				<div id="joy1Div" style="width:200px;height:200px;"></div>
				Posizione X:<input id="joy1PosizioneX" type="text" /><br />
				Posizione Y:<input id="joy1PosizioneY" type="text" /><br />
				Direzione:<input id="joy1Direzione" type="text" /><br />
				X :<input id="joy1X" type="text" /></br>
				Y :<input id="joy1Y" type="text" />
			</div>
		
		</div>
		  <input type="range" class="slider" value="50" />
		</div>
		<div class="grid-item">
            <i class="fa-solid fa-head-side-mask"></i>
            <i class="fa-solid fa-temperature-low"></i>
            <i class="fa-solid fa-sun"></i>
            <i class="fa-solid fa-gauge-high"></i>
            <i class="fa-solid fa-location-crosshairs"></i>
            <i class="fa-solid fa-wind"></i>
			Atmospheric pressure: 300KPa<br>
			Temperature: 300KPa<br>
			Brightness: 300KPa<br>
			Speed: 300KPa<br>
			Air quality: 300KPa<br>
			CO concentration: 300KPa<br>
		</div>
	</div>
    <div class="right-grid-subcontainer">
		<div class="grid-item">
			<iframe width='100%' height='100%' src="https://api.mapbox.com/styles/v1/lebedei/clsbx922m00ck01qzc9cc42q1.html?title=false&access_token=pk.eyJ1IjoibGViZWRlaSIsImEiOiJjbHJsMjh2b3UwbW5qMmtrMGN2Zzh3ZnZkIn0.mgAxc18VxnZtgJr8zwVg4w&zoomwheel=false#13.84/60.17619/24.80732" title="Streets" style="border:none;"></iframe>
		</div>
	</div>
  </div>

  <script>
	mapboxgl.accessToken = 'pk.eyJ1IjoibGViZWRlaSIsImEiOiJjbHJsMjh2b3UwbW5qMmtrMGN2Zzh3ZnZkIn0.mgAxc18VxnZtgJr8zwVg4w';
    const map = new mapboxgl.Map({
        container: 'map-container',
        // Choose from Mapbox's core styles, or make your own style with Mapbox Studio
        style: 'mapbox://styles/mapbox/streets-v12',
        zoom: 4.4
    });
    
    map.on('load', async () => {
        // Get the initial location of the International Space Station (ISS).
        const geojson = await getLocation();
        // Add the ISS location as a source.
        map.addSource('iss', {
            type: 'geojson',
            data: geojson
        });
        // Add the rocket symbol layer to the map.
        map.addLayer({
            'id': 'iss',
            'type': 'symbol',
            'source': 'iss',
            'layout': {
            // This icon is a part of the Mapbox Streets style.
            // To view all images available in a Mapbox style, open
            // the style in Mapbox Studio and click the "Images" tab.
            // To add a new image to the style at runtime see
            // https://docs.mapbox.com/mapbox-gl-js/example/add-image/
            'icon-image': 'rocket'
        }
        });
    
    // Update the source from the API every 2 seconds.
    const updateSource = setInterval(async () => {
        const geojson = await getLocation(updateSource);
        map.getSource('iss').setData(geojson);
    }, 200);
    
    async function getLocation(updateSource) {
        // Make a GET request to the API and return the location of the ISS.
        try {
            const response = await fetch(
            'https://api.wheretheiss.at/v1/satellites/25544',
            { method: 'GET' }
            );
            const { latitude, longitude } = await response.json();
            // Fly the map to the location.
            map.flyTo({
                center: [longitude, latitude],
                speed: 0.5,
                zoom:7
            });
            // Return the location of the ISS as GeoJSON.
            return {
            'type': 'FeatureCollection',
            'features': [
            {
            'type': 'Feature',
            'geometry': {
            'type': 'Point',
            'coordinates': [longitude, latitude]
            }
        }
        ]
        };
        } catch (err) {
            // If the updateSource interval is defined, clear the interval to stop updating the source.
            if (updateSource) clearInterval(updateSource);
                throw new Error(err);
            }
        }
    });
</script>
 
		<script type="text/javascript">

var joy1IinputPosX = document.getElementById("joy1PosizioneX");
var joy1InputPosY = document.getElementById("joy1PosizioneY");
var joy1Direzione = document.getElementById("joy1Direzione");
var joy1X = document.getElementById("joy1X");
var joy1Y = document.getElementById("joy1Y");

var Joy1 = new JoyStick('joy1Div', {}, function(stickData) {
    joy1IinputPosX.value = stickData.xPosition;
    joy1InputPosY.value = stickData.yPosition;
    joy1Direzione.value = stickData.cardinalDirection;
    joy1X.value = stickData.x;
    joy1Y.value = stickData.y;
});

		</script>

</body>
</html>
